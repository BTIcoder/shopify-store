{{ 'header-clean.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign has_social = false
  if settings.social_twitter_link != blank or settings.social_facebook_link != blank or settings.social_pinterest_link != blank or settings.social_instagram_link != blank or settings.social_youtube_link != blank
    assign has_social = true
  endif

  assign has_localization = false
  if localization.available_countries.size > 1 and section.settings.enable_country_selector or section.settings.enable_language_selector and localization.available_languages.size > 1
    assign has_localization = true
  endif
-%}

<header class="header-clean" data-sticky-header>
  <div class="header-clean__wrapper">
    <!-- Logo -->
    <a href="{{ routes.root_url }}" class="header-clean__logo">
      {%- if settings.logo != blank -%}
        {%- assign logo_alt = settings.logo.alt | default: shop.name | escape -%}
        {%- assign logo_height = 40 -%}
        {{ settings.logo | image_url: width: 200 | image_tag:
          class: 'header-clean__logo-image',
          alt: logo_alt,
          height: logo_height,
          loading: 'eager',
          preload: true
        }}
      {%- else -%}
        {{ shop.name }}
      {%- endif -%}
    </a>

    <!-- Enhanced Navigation with Dropdowns -->
    <nav class="header-clean__nav">
      <!-- Furniture Legs Dropdown -->
      <div class="header-clean__nav-item">
        <a href="/collections/furniture-legs" class="header-clean__nav-link">
          FURNITURE LEGS
          <svg class="header-clean__nav-arrow" viewBox="0 0 24 24" fill="none">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </a>
        <div class="header-clean__dropdown">
          <div class="header-clean__dropdown-content">
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">By Furniture Type</h4>
              <div class="header-clean__dropdown-links">
                <a href="/collections/cabinet-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Cabinet Legs</span>
                    <span class="header-clean__dropdown-link-desc">Lift your cabinets with style</span>
                  </div>
                </a>
                <a href="/collections/sofa-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <path d="M3 11h18v8a2 2 0 01-2 2H5a2 2 0 01-2-2v-8z"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Sofa Legs</span>
                    <span class="header-clean__dropdown-link-desc">Perfect for IKEA & other brands</span>
                  </div>
                </a>
                <a href="/collections/table-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <path d="M3 12h18l-2-9H5l-2 9z"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Table Legs</span>
                    <span class="header-clean__dropdown-link-desc">Various heights & styles</span>
                  </div>
                </a>
                <a href="/collections/bed-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="2" y="4" width="20" height="16" rx="2"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Bed Legs</span>
                    <span class="header-clean__dropdown-link-desc">Wood & metal options</span>
                  </div>
                </a>
              </div>
            </div>
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">By Material</h4>
              <div class="header-clean__dropdown-categories">
                <a href="/collections/brass-legs" class="header-clean__dropdown-category">Brass</a>
                <a href="/collections/steel-legs" class="header-clean__dropdown-category">Steel</a>
                <a href="/collections/wood-legs" class="header-clean__dropdown-category">Wood</a>
                <a href="/collections/all-legs" class="header-clean__dropdown-category">View All</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Knobs & Handles Dropdown -->
      <div class="header-clean__nav-item">
        <a href="/collections/knobs-handles" class="header-clean__nav-link">
          KNOBS/HANDLES
          <svg class="header-clean__nav-arrow" viewBox="0 0 24 24" fill="none">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </a>
        <div class="header-clean__dropdown">
          <div class="header-clean__dropdown-content">
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">Hardware Types</h4>
              <div class="header-clean__dropdown-links">
                <a href="/collections/knobs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <circle cx="12" cy="12" r="8"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Knobs</span>
                    <span class="header-clean__dropdown-link-desc">Cabinet & drawer knobs</span>
                  </div>
                </a>
                <a href="/collections/handles" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="4" y="11" width="16" height="2" rx="1"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Handles</span>
                    <span class="header-clean__dropdown-link-desc">Bar & pull handles</span>
                  </div>
                </a>
                <a href="/collections/concealed-handles" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <path d="M4 12h16l-4-4m4 4l-4 4"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Concealed Handles</span>
                    <span class="header-clean__dropdown-link-desc">Modern hidden solutions</span>
                  </div>
                </a>
                <a href="/collections/door-handles" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="3" y="4" width="18" height="16" rx="2"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Door Handles</span>
                    <span class="header-clean__dropdown-link-desc">Main door hardware</span>
                  </div>
                </a>
              </div>
            </div>
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">Materials</h4>
              <div class="header-clean__dropdown-categories">
                <a href="/collections/ss304-hardware" class="header-clean__dropdown-category">SS 304</a>
                <a href="/collections/zinc-alloy" class="header-clean__dropdown-category">Zinc Alloy</a>
                <a href="/collections/aluminum" class="header-clean__dropdown-category">Aluminum</a>
                <a href="/collections/all-hardware" class="header-clean__dropdown-category">View All</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Premium Plywood -->
      <div class="header-clean__nav-item">
        <a href="/pages/plywood" class="header-clean__nav-link">PREMIUM PLYWOOD</a>
      </div>

      <!-- About -->
      <div class="header-clean__nav-item">
        <a href="/pages/about" class="header-clean__nav-link">ABOUT</a>
      </div>
    </nav>

    <!-- Right Actions -->
    <div class="header-clean__actions">
      <!-- Enhanced Search Bar -->
      {%- if section.settings.enable_search -%}
        <div class="header-clean__search-container">
          <form action="{{ routes.search_url }}" method="get" class="header-clean__search-form">
            <div class="header-clean__search-wrapper">
              <svg class="header-clean__search-icon" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.35-4.35"/>
              </svg>
              <input 
                type="search" 
                name="q" 
                class="header-clean__search-field"
                placeholder="Search furniture legs, knobs, handles..."
                value="{{ search.terms | escape }}"
                autocomplete="off"
                data-search-input
              >
              <button type="button" class="header-clean__search-clear" onclick="clearSearch()" aria-label="Clear search">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div class="header-clean__search-dropdown" data-search-dropdown>
              <div class="header-clean__search-suggestions">
                <div class="header-clean__search-section">
                  <h4 class="header-clean__search-title">Popular Searches</h4>
                  <div class="header-clean__search-links">
                    <a href="/collections/furniture-legs" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                        <line x1="15" y1="9" x2="9" y2="15"/>
                      </svg>
                      Furniture Legs
                    </a>
                    <a href="/collections/knobs-handles" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="3"/>
                        <circle cx="12" cy="12" r="8"/>
                      </svg>
                      Knobs & Handles
                    </a>
                    <a href="/collections/cabinet-legs" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                      </svg>
                      Cabinet Legs
                    </a>
                    <a href="/collections/table-legs" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <path d="M12 3v18m-4-4l4 4 4-4"/>
                      </svg>
                      Table Legs
                    </a>
                  </div>
                </div>
                
                <div class="header-clean__search-section">
                  <h4 class="header-clean__search-title">Categories</h4>
                  <div class="header-clean__search-categories">
                    <a href="/collections/all" class="header-clean__search-category">All Products</a>
                    <a href="/collections/brass-collection" class="header-clean__search-category">Brass Collection</a>
                    <a href="/collections/steel-collection" class="header-clean__search-category">Steel Collection</a>
                    <a href="/collections/wood-collection" class="header-clean__search-category">Wood Collection</a>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      {%- endif -%}
      <!-- Cart -->
      <a href="{{ routes.cart_url }}" class="header-clean__cart" aria-label="Shopping cart">
        <svg class="header-clean__icon" viewBox="0 0 24 24" fill="none">
          <path d="M3 3h2l.4 2M7 13h10l4-8H5.4m1.6 8L6 21v-8m1 8h10"/>
        </svg>
        {%- if cart.item_count > 0 -%}
          <span class="header-clean__cart-count">{{ cart.item_count }}</span>
        {%- endif -%}
      </a>

      <!-- Mobile Menu Toggle -->
      <button class="header-clean__menu-toggle" aria-label="Menu" onclick="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
</header>

<script>
  // Enhanced Search Functionality
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.querySelector('[data-search-input]');
    const searchDropdown = document.querySelector('[data-search-dropdown]');
    const searchClear = document.querySelector('.header-clean__search-clear');
    
    if (searchInput && searchDropdown) {
      // Show dropdown on focus
      searchInput.addEventListener('focus', function() {
        searchDropdown.classList.add('active');
      });
      
      // Hide dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.header-clean__search-container')) {
          searchDropdown.classList.remove('active');
        }
      });
      
      // Show/hide clear button
      searchInput.addEventListener('input', function() {
        if (this.value.length > 0) {
          searchClear.style.display = 'flex';
        } else {
          searchClear.style.display = 'none';
        }
      });
      
      // Initial state for clear button
      if (searchInput.value.length > 0) {
        searchClear.style.display = 'flex';
      }
    }

    // Enhanced Navigation Dropdown Functionality
    const navItems = document.querySelectorAll('.header-clean__nav-item');
    
    navItems.forEach(function(navItem) {
      const dropdown = navItem.querySelector('.header-clean__dropdown');
      
      if (dropdown) {
        let hoverTimeout;
        
        // Show dropdown on hover
        navItem.addEventListener('mouseenter', function() {
          clearTimeout(hoverTimeout);
          dropdown.style.display = 'block';
          // Small delay to allow CSS transition
          setTimeout(() => {
            dropdown.style.opacity = '1';
            dropdown.style.visibility = 'visible';
            dropdown.style.transform = 'translateX(-50%) translateY(0)';
          }, 10);
        });
        
        // Hide dropdown on leave with delay
        navItem.addEventListener('mouseleave', function() {
          hoverTimeout = setTimeout(() => {
            dropdown.style.opacity = '0';
            dropdown.style.visibility = 'hidden';
            dropdown.style.transform = 'translateX(-50%) translateY(-10px)';
            
            // Hide after transition completes
            setTimeout(() => {
              if (dropdown.style.opacity === '0') {
                dropdown.style.display = 'none';
              }
            }, 300);
          }, 100);
        });
      }
    });
  });
  
  // Clear search function
  function clearSearch() {
    const searchInput = document.querySelector('[data-search-input]');
    const searchClear = document.querySelector('.header-clean__search-clear');
    if (searchInput) {
      searchInput.value = '';
      searchInput.focus();
      searchClear.style.display = 'none';
    }
  }

  // Mobile Menu Toggle (keep existing functionality)
  function toggleMobileMenu() {
    // Add mobile menu functionality here
    console.log('Mobile menu toggle');
  }
</script>

<script>
  // Search Toggle with improved animations
  function toggleSearch() {
    const searchInput = document.getElementById('searchInput');
    const searchField = searchInput.querySelector('.header-clean__search-field');
    const body = document.body;
    
    if (searchInput.classList.contains('active')) {
      searchInput.classList.remove('active');
      body.classList.remove('search-active');
    } else {
      searchInput.classList.add('active');
      body.classList.add('search-active');
      // Focus with a slight delay to allow animation
      setTimeout(() => searchField.focus(), 200);
    }
  }

  // Mobile Menu Toggle (placeholder - implement mobile menu as needed)
  function toggleMobileMenu() {
    console.log('Mobile menu toggle - implement as needed');
    // Implement mobile menu functionality
  }

  // Close search when clicking outside or pressing Escape
  document.addEventListener('click', function(e) {
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.querySelector('.header-clean__search');
    
    if (!searchInput.contains(e.target) && !searchButton.contains(e.target)) {
      if (searchInput.classList.contains('active')) {
        toggleSearch();
      }
    }
  });

  // Close search on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      const searchInput = document.getElementById('searchInput');
      if (searchInput.classList.contains('active')) {
        toggleSearch();
      }
    }
  });

  // Sticky header on scroll with performance optimization
  let ticking = false;
  
  function updateHeader() {
    const header = document.querySelector('.header-clean');
    if (window.scrollY > 100) {
      header.classList.add('scrolled');
    } else {
      header.classList.remove('scrolled');
    }
    ticking = false;
  }
  
  window.addEventListener('scroll', function() {
    if (!ticking) {
      requestAnimationFrame(updateHeader);
      ticking = true;
    }
  });

  // Prevent body scroll when search is active (optional)
  const style = document.createElement('style');
  style.textContent = `
    body.search-active {
      overflow: hidden;
    }
    
    @media (min-width: 768px) {
      body.search-active {
        overflow: auto;
      }
    }
  `;
  document.head.appendChild(style);
</script>

{% schema %}
{
  "name": "Clean Header",
  "class": "section-header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "default": true,
      "label": "Enable search"
    },
    {
      "type": "checkbox",
      "id": "enable_country_selector",
      "default": false,
      "label": "Enable country/region selector",
      "info": "To add a country/region selector, go to your [language settings.](/admin/settings/languages)"
    },
    {
      "type": "checkbox",
      "id": "enable_language_selector",
      "default": false,
      "label": "Enable language selector",
      "info": "To add a language selector, go to your [language settings.](/admin/settings/languages)"
    }
  ]
}
{% endschema %}
