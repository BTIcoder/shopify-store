{{ 'header-clean.css' | asset_url | stylesheet_tag }}
{{ 'mobile-menu-fix.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign has_social = false
  if settings.social_twitter_link != blank or settings.social_facebook_link != blank or settings.social_pinterest_link != blank or settings.social_instagram_link != blank or settings.social_youtube_link != blank
    assign has_social = true
  endif

  assign has_localization = false
  if localization.available_countries.size > 1 and section.settings.enable_country_selector or section.settings.enable_language_selector and localization.available_languages.size > 1
    assign has_localization = true
  endif
-%}

<header class="header-clean" data-sticky-header>
  <div class="header-clean__wrapper">
    <!-- Logo (Left Side) -->
    <a href="{{ routes.root_url }}" class="header-clean__logo">
      {%- if settings.logo != blank -%}
        {%- assign logo_alt = settings.logo.alt | default: shop.name | escape -%}
        {%- assign logo_height = 35 -%}
        {{ settings.logo | image_url: width: 160 | image_tag:
          class: 'header-clean__logo-image',
          alt: logo_alt,
          height: logo_height,
          loading: 'eager',
          preload: true
        }}
      {%- else -%}
        <div class="header-clean__logo-brand">
          <div class="header-clean__logo-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
          </div>
          <span class="header-clean__brand-name">{{ shop.name }}</span>
        </div>
      {%- endif -%}
    </a>

    <!-- Enhanced Navigation with Dropdowns -->
    <nav class="header-clean__nav">
      <!-- Furniture Legs Dropdown -->
      <div class="header-clean__nav-item">
        <a href="/collections/furniture-legs" class="header-clean__nav-link">
          FURNITURE LEGS
          <svg class="header-clean__nav-arrow" viewBox="0 0 24 24" fill="none">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </a>
        <div class="header-clean__dropdown">
          <div class="header-clean__dropdown-content">
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">By Furniture Type</h4>
              <div class="header-clean__dropdown-links">
                <a href="/collections/cabinet-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="3" y="3" width="18" height="18" rx="2"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Cabinet Legs</span>
                    <span class="header-clean__dropdown-link-desc">Lift your cabinets with style</span>
                  </div>
                </a>
                <a href="/collections/sofa-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <path d="M3 11h18v8a2 2 0 01-2 2H5a2 2 0 01-2-2v-8z"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Sofa Legs</span>
                    <span class="header-clean__dropdown-link-desc">Perfect for IKEA & other brands</span>
                  </div>
                </a>
                <a href="/collections/table-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <path d="M3 12h18l-2-9H5l-2 9z"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Table Legs</span>
                    <span class="header-clean__dropdown-link-desc">Various heights & styles</span>
                  </div>
                </a>
                <a href="/collections/bed-legs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="2" y="4" width="20" height="16" rx="2"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Bed Legs</span>
                    <span class="header-clean__dropdown-link-desc">Wood & metal options</span>
                  </div>
                </a>
              </div>
            </div>
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">By Material</h4>
              <div class="header-clean__dropdown-categories">
                <a href="/collections/brass-legs" class="header-clean__dropdown-category">Brass</a>
                <a href="/collections/steel-legs" class="header-clean__dropdown-category">Steel</a>
                <a href="/collections/wood-legs" class="header-clean__dropdown-category">Wood</a>
                <a href="/collections/all-legs" class="header-clean__dropdown-category">View All</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Knobs & Handles Dropdown -->
      <div class="header-clean__nav-item">
        <a href="/collections/knobs-handles" class="header-clean__nav-link">
          KNOBS/HANDLES
          <svg class="header-clean__nav-arrow" viewBox="0 0 24 24" fill="none">
            <path d="M6 9l6 6 6-6"/>
          </svg>
        </a>
        <div class="header-clean__dropdown">
          <div class="header-clean__dropdown-content">
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">Hardware Types</h4>
              <div class="header-clean__dropdown-links">
                <a href="/collections/knobs" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <circle cx="12" cy="12" r="8"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Knobs</span>
                    <span class="header-clean__dropdown-link-desc">Cabinet & drawer knobs</span>
                  </div>
                </a>
                <a href="/collections/handles" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="4" y="11" width="16" height="2" rx="1"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Handles</span>
                    <span class="header-clean__dropdown-link-desc">Bar & pull handles</span>
                  </div>
                </a>
                <a href="/collections/concealed-handles" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <path d="M4 12h16l-4-4m4 4l-4 4"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Concealed Handles</span>
                    <span class="header-clean__dropdown-link-desc">Modern hidden solutions</span>
                  </div>
                </a>
                <a href="/collections/door-handles" class="header-clean__dropdown-link">
                  <div class="header-clean__dropdown-icon">
                    <svg viewBox="0 0 24 24" fill="none">
                      <rect x="3" y="4" width="18" height="16" rx="2"/>
                    </svg>
                  </div>
                  <div>
                    <span class="header-clean__dropdown-link-title">Door Handles</span>
                    <span class="header-clean__dropdown-link-desc">Main door hardware</span>
                  </div>
                </a>
              </div>
            </div>
            <div class="header-clean__dropdown-section">
              <h4 class="header-clean__dropdown-title">Materials</h4>
              <div class="header-clean__dropdown-categories">
                <a href="/collections/ss304-hardware" class="header-clean__dropdown-category">SS 304</a>
                <a href="/collections/zinc-alloy" class="header-clean__dropdown-category">Zinc Alloy</a>
                <a href="/collections/aluminum" class="header-clean__dropdown-category">Aluminum</a>
                <a href="/collections/all-hardware" class="header-clean__dropdown-category">View All</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Premium Plywood -->
      <div class="header-clean__nav-item">
        <a href="/pages/plywood" class="header-clean__nav-link">PREMIUM PLYWOOD</a>
      </div>

      <!-- About -->
      <div class="header-clean__nav-item">
        <a href="/pages/about" class="header-clean__nav-link">ABOUT</a>
      </div>
    </nav>

    <!-- Right Actions -->
    <div class="header-clean__actions">
      <!-- Compact Delivery Info (Right Side) -->
      <div class="header-clean__delivery-info">
        <span class="header-clean__delivery-badge">60</span>
        <span class="header-clean__delivery-text">Mins</span>
        <div class="header-clean__location-compact">
          <svg class="header-clean__location-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
          <span class="header-clean__location-code">560087</span>
          <svg class="header-clean__location-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"/>
          </svg>
        </div>
      </div>

      <!-- Enhanced Search Bar -->
      {%- if section.settings.enable_search -%}
        <div class="header-clean__search-container">
          <form action="{{ routes.search_url }}" method="get" class="header-clean__search-form">
            <div class="header-clean__search-wrapper">
              <svg class="header-clean__search-icon" viewBox="0 0 24 24" fill="none">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.35-4.35"/>
              </svg>
              <input 
                type="search" 
                name="q" 
                class="header-clean__search-field"
                placeholder="Search furniture legs, knobs, handles..."
                value="{{ search.terms | escape }}"
                autocomplete="off"
                data-search-input
              >
              <button type="button" class="header-clean__search-clear" onclick="clearSearch()" aria-label="Clear search">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div class="header-clean__search-dropdown" data-search-dropdown>
              <div class="header-clean__search-suggestions">
                <div class="header-clean__search-section">
                  <h4 class="header-clean__search-title">Popular Searches</h4>
                  <div class="header-clean__search-links">
                    <a href="/collections/furniture-legs" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                        <line x1="15" y1="9" x2="9" y2="15"/>
                      </svg>
                      Furniture Legs
                    </a>
                    <a href="/collections/knobs-handles" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="3"/>
                        <circle cx="12" cy="12" r="8"/>
                      </svg>
                      Knobs & Handles
                    </a>
                    <a href="/collections/cabinet-legs" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <line x1="9" y1="9" x2="15" y2="15"/>
                      </svg>
                      Cabinet Legs
                    </a>
                    <a href="/collections/table-legs" class="header-clean__search-link">
                      <svg class="header-clean__search-link-icon" viewBox="0 0 24 24" fill="none">
                        <path d="M12 3v18m-4-4l4 4 4-4"/>
                      </svg>
                      Table Legs
                    </a>
                  </div>
                </div>
                
                <div class="header-clean__search-section">
                  <h4 class="header-clean__search-title">Categories</h4>
                  <div class="header-clean__search-categories">
                    <a href="/collections/all" class="header-clean__search-category">All Products</a>
                    <a href="/collections/brass-collection" class="header-clean__search-category">Brass Collection</a>
                    <a href="/collections/steel-collection" class="header-clean__search-category">Steel Collection</a>
                    <a href="/collections/wood-collection" class="header-clean__search-category">Wood Collection</a>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      {%- endif -%}
      
      <!-- Enhanced Cart -->
      <a href="{{ routes.cart_url }}" class="header-clean__cart" aria-label="Shopping cart">
        <div class="header-clean__cart-wrapper">
          <svg class="header-clean__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"/>
            <circle cx="20" cy="21" r="1"/>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
          </svg>
          {%- if cart.item_count > 0 -%}
            <span class="header-clean__cart-count">{{ cart.item_count }}</span>
          {%- else -%}
            <span class="header-clean__cart-count header-clean__cart-count--empty">1</span>
          {%- endif -%}
        </div>
      </a>

      <!-- Mobile Menu Toggle -->
      <button class="header-clean__menu-toggle" aria-label="Menu">
        <span class="header-clean__menu-line"></span>
        <span class="header-clean__menu-line"></span>
        <span class="header-clean__menu-line"></span>
      </button>
    </div>
</header>

<!-- Mobile Sidebar Menu - OUTSIDE HEADER FOR FULL SCREEN -->
<div class="header-clean__mobile-menu" id="mobileMenu">
  <div class="header-clean__mobile-menu-overlay" onclick="window.closeMobileMenu()"></div>
  <div class="header-clean__mobile-menu-content">
        <div class="header-clean__mobile-menu-header">
          <span class="header-clean__mobile-brand-name">Hardrex</span>
          <button class="header-clean__mobile-close" onclick="window.closeMobileMenu()" aria-label="Close menu">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <nav class="header-clean__mobile-nav">
          <!-- Main Navigation Items -->
          <a href="/collections/handles" class="header-clean__mobile-nav-item">
            <span>HANDLES</span>
            <svg class="header-clean__mobile-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9,18 15,12 9,6"/>
            </svg>
          </a>

          <a href="/collections/knobs" class="header-clean__mobile-nav-item">
            <span>KNOBS</span>
            <svg class="header-clean__mobile-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9,18 15,12 9,6"/>
            </svg>
          </a>

          <a href="/collections/hooks" class="header-clean__mobile-nav-item">
            <span>HOOKS</span>
            <svg class="header-clean__mobile-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9,18 15,12 9,6"/>
            </svg>
          </a>

          <a href="/collections" class="header-clean__mobile-nav-item">
            <span>COLLECTIONS</span>
            <svg class="header-clean__mobile-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9,18 15,12 9,6"/>
            </svg>
          </a>

          <a href="/pages/contact" class="header-clean__mobile-nav-item">
            <span>CONTACT US</span>
            <svg class="header-clean__mobile-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9,18 15,12 9,6"/>
            </svg>
          </a>

          <a href="/blogs/news" class="header-clean__mobile-nav-item">
            <span>BLOGS</span>
          </a>
        </nav>

        <!-- Mobile Footer Section -->
        <div class="header-clean__mobile-footer">
          <!-- Login Section -->
          <div class="header-clean__mobile-login">
            {%- if customer -%}
              <a href="{{ routes.account_url }}" class="header-clean__mobile-login-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                  <circle cx="12" cy="7" r="4"/>
                </svg>
                <span>My Account</span>
              </a>
            {%- else -%}
              <a href="{{ routes.account_login_url }}" class="header-clean__mobile-login-link">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                  <circle cx="12" cy="7" r="4"/>
                </svg>
                <span>Log in</span>
              </a>
            {%- endif -%}
          </div>

          <!-- Social Links -->
          <div class="header-clean__mobile-social">
            {%- if settings.social_pinterest_link != blank -%}
              <a href="{{ settings.social_pinterest_link }}" class="header-clean__social-link" target="_blank" rel="noopener" aria-label="Pinterest">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 0C5.373 0 0 5.372 0 12s5.373 12 12 12c6.628 0 12-5.372 12-12S18.628 0 12 0zm0 19c-.721 0-1.418-.109-2.073-.312.286-.465.713-1.227.87-1.835l.437-1.664c.229.436.895.818 1.604.818 2.111 0 3.633-1.941 3.633-4.354 0-2.312-1.888-4.042-4.316-4.042-3.021 0-4.625 2.003-4.625 4.137 0 .695.366 1.56.947 1.836.095.045.146.025.168-.067l.218-.895c.018-.072.009-.095-.035-.157-.121-.181-.277-.511-.277-.92 0-1.186.906-2.357 2.466-2.357 1.342 0 2.28.867 2.28 2.104 0 1.588-.632 2.63-1.411 2.63-.422 0-.737-.35-.636-.777.12-.508.353-1.056.353-1.421 0-.328-.176-.602-.54-.602-.428 0-.772.443-.772 1.037 0 .378.128.633.128.633s-.433 1.834-.509 2.168c-.025.11-.004.235-.002.343-.916-.398-1.677-.777-2.702-1.604C3.146 17.402 1.5 14.902 1.5 12 1.5 6.201 6.201 1.5 12 1.5S22.5 6.201 22.5 12 17.799 22.5 12 22.5z"/>
                </svg>
              </a>
            {%- endif -%}

            {%- if settings.social_instagram_link != blank -%}
              <a href="{{ settings.social_instagram_link }}" class="header-clean__social-link" target="_blank" rel="noopener" aria-label="Instagram">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
              </a>
            {%- endif -%}

            {%- if settings.social_linkedin_link != blank -%}
              <a href="{{ settings.social_linkedin_link }}" class="header-clean__social-link" target="_blank" rel="noopener" aria-label="LinkedIn">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </a>
            {%- endif -%}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Enhanced Search Functionality
  document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.querySelector('[data-search-input]');
    const searchDropdown = document.querySelector('[data-search-dropdown]');
    const searchClear = document.querySelector('.header-clean__search-clear');
    
    if (searchInput && searchDropdown) {
      // Show dropdown on focus
      searchInput.addEventListener('focus', function() {
        searchDropdown.classList.add('active');
      });
      
      // Hide dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.header-clean__search-container')) {
          searchDropdown.classList.remove('active');
        }
      });
      
      // Show/hide clear button
      searchInput.addEventListener('input', function() {
        if (this.value.length > 0) {
          searchClear.style.display = 'flex';
        } else {
          searchClear.style.display = 'none';
        }
      });
      
      // Initial state for clear button
      if (searchInput.value.length > 0) {
        searchClear.style.display = 'flex';
      }
    }

    // Enhanced Navigation Dropdown Functionality
    const navItems = document.querySelectorAll('.header-clean__nav-item');
    
    navItems.forEach(function(navItem) {
      const dropdown = navItem.querySelector('.header-clean__dropdown');
      
      if (dropdown) {
        let hoverTimeout;
        
        // Show dropdown on hover
        navItem.addEventListener('mouseenter', function() {
          clearTimeout(hoverTimeout);
          dropdown.style.display = 'block';
          // Small delay to allow CSS transition
          setTimeout(() => {
            dropdown.style.opacity = '1';
            dropdown.style.visibility = 'visible';
            dropdown.style.transform = 'translateX(0) translateY(0)';
          }, 10);
        });
        
        // Hide dropdown on leave with delay
        navItem.addEventListener('mouseleave', function() {
          hoverTimeout = setTimeout(() => {
            dropdown.style.opacity = '0';
            dropdown.style.visibility = 'hidden';
            dropdown.style.transform = 'translateX(0) translateY(-10px)';
            
            // Hide after transition completes
            setTimeout(() => {
              if (dropdown.style.opacity === '0') {
                dropdown.style.display = 'none';
              }
            }, 300);
          }, 100);
        });
      }
    });
  });
  
  // Clear search function
  function clearSearch() {
    const searchInput = document.querySelector('[data-search-input]');
    const searchClear = document.querySelector('.header-clean__search-clear');
    if (searchInput) {
      searchInput.value = '';
      searchInput.focus();
      searchClear.style.display = 'none';
    }
  }

  // Mobile Menu Functions - Safe Implementation
  window.toggleMobileMenu = function() {
    try {
      console.log('Toggle mobile menu clicked');
      const mobileMenu = document.getElementById('mobileMenu');
      const menuToggle = document.querySelector('.header-clean__menu-toggle');
      const body = document.body;
      
      if (!mobileMenu) {
        console.error('Mobile menu element not found');
        return;
      }
      
      if (mobileMenu.classList.contains('active')) {
        window.closeMobileMenu();
      } else {
        mobileMenu.classList.add('active');
        if (menuToggle) menuToggle.classList.add('active');
        body.classList.add('mobile-menu-open');
        console.log('Mobile menu opened');
      }
    } catch (error) {
      console.error('Error in toggleMobileMenu:', error);
    }
  };

  window.closeMobileMenu = function() {
    try {
      console.log('Closing mobile menu');
      const mobileMenu = document.getElementById('mobileMenu');
      const menuToggle = document.querySelector('.header-clean__menu-toggle');
      const body = document.body;
      
      if (mobileMenu) mobileMenu.classList.remove('active');
      if (menuToggle) menuToggle.classList.remove('active');
      body.classList.remove('mobile-menu-open');
    } catch (error) {
      console.error('Error in closeMobileMenu:', error);
    }
  };

  window.toggleMobileSubmenu = function(button) {
    try {
      console.log('Toggle submenu clicked');
      if (!button) return;
      
      const submenu = button.nextElementSibling;
      const arrow = button.querySelector('.header-clean__mobile-arrow');
      
      if (!submenu) {
        console.error('Submenu not found');
        return;
      }
      
      if (submenu.classList.contains('active')) {
        submenu.classList.remove('active');
        if (arrow) arrow.style.transform = 'rotate(0deg)';
      } else {
        // Close other submenus
        const activeMenus = document.querySelectorAll('.header-clean__mobile-submenu.active');
        activeMenus.forEach(menu => {
          menu.classList.remove('active');
          const prevButton = menu.previousElementSibling;
          const prevArrow = prevButton ? prevButton.querySelector('.header-clean__mobile-arrow') : null;
          if (prevArrow) prevArrow.style.transform = 'rotate(0deg)';
        });
        
        submenu.classList.add('active');
        if (arrow) arrow.style.transform = 'rotate(180deg)';
      }
    } catch (error) {
      console.error('Error in toggleMobileSubmenu:', error);
    }
  };

  // DOM ready check for mobile menu
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, checking mobile menu elements...');
    const mobileMenu = document.getElementById('mobileMenu');
    const menuToggle = document.querySelector('.header-clean__menu-toggle');
    const closeButton = document.querySelector('.header-clean__mobile-close');
    const overlay = document.querySelector('.header-clean__mobile-menu-overlay');
    
    if (mobileMenu) {
      console.log('Mobile menu found successfully');
    } else {
      console.error('Mobile menu element not found in DOM');
    }
    
    if (menuToggle) {
      console.log('Menu toggle button found successfully');
      // Add single click event listener
      menuToggle.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('Menu toggle clicked via event listener');
        window.toggleMobileMenu();
      });
    } else {
      console.error('Menu toggle button not found in DOM');
    }

    // Add close button event listener
    if (closeButton) {
      closeButton.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('Close button clicked');
        window.closeMobileMenu();
      });
    }

    // Add overlay click to close
    if (overlay) {
      overlay.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('Overlay clicked');
        window.closeMobileMenu();
      });
    }

    // Prevent menu content clicks from closing menu
    const menuContent = document.querySelector('.header-clean__mobile-menu-content');
    if (menuContent) {
      menuContent.addEventListener('click', function(e) {
        e.stopPropagation();
      });
    }
  });
</script>

<script>
  // Search Toggle with improved animations
  function toggleSearch() {
    const searchInput = document.getElementById('searchInput');
    if (!searchInput) {
      console.log('Search input element not found');
      return;
    }
    
    const searchField = searchInput.querySelector('.header-clean__search-field');
    const body = document.body;
    
    if (searchInput.classList.contains('active')) {
      searchInput.classList.remove('active');
      body.classList.remove('search-active');
    } else {
      searchInput.classList.add('active');
      body.classList.add('search-active');
      // Focus with a slight delay to allow animation
      if (searchField) {
        setTimeout(() => searchField.focus(), 200);
      }
    }
  }

  // Mobile menu functions are now properly defined above

  // Close search when clicking outside or pressing Escape
  document.addEventListener('click', function(e) {
    // Skip this functionality since searchInput element doesn't exist in current implementation
    // This prevents the null reference error
    return;
  });

  // Close search on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      // Close mobile menu on escape
      if (window.closeMobileMenu) {
        window.closeMobileMenu();
      }
    }
  });

  // Sticky header on scroll with performance optimization
  let ticking = false;
  
  function updateHeader() {
    const header = document.querySelector('.header-clean');
    if (window.scrollY > 100) {
      header.classList.add('scrolled');
    } else {
      header.classList.remove('scrolled');
    }
    ticking = false;
  }
  
  window.addEventListener('scroll', function() {
    if (!ticking) {
      requestAnimationFrame(updateHeader);
      ticking = true;
    }
  });

  // Prevent body scroll when search is active (optional)
  const style = document.createElement('style');
  style.textContent = `
    body.search-active {
      overflow: hidden;
    }
    
    @media (min-width: 768px) {
      body.search-active {
        overflow: auto;
      }
    }
  `;
  document.head.appendChild(style);
</script>

{% schema %}
{
  "name": "Clean Header",
  "class": "section-header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "checkbox",
      "id": "enable_search",
      "default": true,
      "label": "Enable search"
    },
    {
      "type": "checkbox",
      "id": "enable_country_selector",
      "default": false,
      "label": "Enable country/region selector",
      "info": "To add a country/region selector, go to your [language settings.](/admin/settings/languages)"
    },
    {
      "type": "checkbox",
      "id": "enable_language_selector",
      "default": false,
      "label": "Enable language selector",
      "info": "To add a language selector, go to your [language settings.](/admin/settings/languages)"
    }
  ]
}
{% endschema %}
